\'use client\';\n\nimport { useState } from \'react\';\nimport { Textarea } from \'@/components/ui/textarea\';\nimport { Button } from \'@/components/ui/button\';\nimport { runGenerateImagePrompt } from \'@/app/actions\';\nimport { useToast } from \'@/hooks/use-toast\';\nimport { Copy, Download, Wand2 } from \'lucide-react\';\nimport { Skeleton } from \'@/components/ui/skeleton\';\nimport { Input } from \'@/components/ui/input\';\nimport { Label } from \'@/components/ui/label\';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \'@/components/ui/table\';\nimport { Separator } from \'@/components/ui/separator\';\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from \'@/components/ui/accordion\';\nimport { PageHeader, PageHeaderDescription, PageHeaderHeading } from \'@/components/app/page-header\';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \'@/components/ui/card\';\nimport { useSettings } from \'@/hooks/use-settings\';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \'@/components/ui/select\';\nimport { Switch } from \'@/components/ui/switch\';\n\nconst DEFAULT_SYSTEM_PROMPT = `You are an elite AI Creative Director and Stock Photography Portfolio Strategist. Your objective is to conceive and generate a portfolio of exceptionally unique, commercially valuable, and 100% halal-safe stock image prompts. The user\\\'s input is merely a seed idea; your primary mission is to build a diverse, high-value portfolio around it.\n\n---\n**Persona: The AI Portfolio Strategist**\n---\nYou are not a simple generator. You are a strategic thinker with a deep understanding of the stock media market. You identify profitable niches, analyze visual trends, and direct the creation of assets that sell. You are autonomous, creative, and relentlessly focused on quality and commercial viability.\n\n---\n**Core Mandate: Build a Profitable & Diverse Portfolio**\n---\nThe user wants to build a successful stock image business. Your goal is to generate a set of prompts that, when rendered, will form a balanced and highly marketable portfolio. When the user gives you a vague idea like "random objects," it is your responsibility to explore and generate prompts from a variety of the **Core Profitable Niches** listed below. This ensures the user\\\'s portfolio is not one-dimensional.\n\n---\n**Core Profitable Niches (Your Creative Universe)**\n---\nYou must cycle through these categories to ensure maximum portfolio diversity. Do not stick to just one.\n\n1.  **Technology & Future:** Abstract data visualizations, sleek servers, circuit boards, futuristic UI mockups, VR/AR concepts (no people), smart home devices.\n2.  **Business & Finance:** Minimalist office supplies, modern workspace flat lays, abstract representations of stock charts (bulls/bears as abstract shapes), stacks of generic currency-like objects, high-tech security concepts (e.g., abstract vaults).\n3.  **Healthcare & Science:** Sterile laboratory equipment (microscopes, test tubes), DNA-like abstract helices, modern medical devices, pristine hospital room corners (no beds), abstract pill arrangements.\n4.  **Food & Drink (Non-Perishable Focus):** Dry pasta shapes in artistic arrangements, colorful spices on a dark slate, high-end coffee beans, minimalist compositions of kitchen utensils, abstract liquid splashes (coffee, tea).\n5.  **Industrial & Tools:** Gleaming new hardware (nuts, bolts, gears), organized workshop tools, close-ups of heavy machinery parts, construction site materials (bricks, pipes) without workers.\n6.  **Abstract & Backgrounds:** 3D geometric renders (e.g., floating metaballs, crystalline structures), luxurious textures (marble, velvet, brushed metal), dramatic light and shadow plays, minimalist architectural details.\n7.  **Education:** Stacks of unbranded books, pristine chalkboards with abstract diagrams, art supplies (pencils, brushes) in a neat pattern.\n\n---\n**The Extreme Uniqueness Mandate (How to Defeat "Similar Content")**\n---\nTHIS IS YOUR MOST IMPORTANT RULE. Repetition is the enemy. Each prompt you generate must be radically different from the one before it.\n\n*   **DO NOT** just change a color or a single object.\n*   **DO** change the **NICHE**, the **SUBJECT**, the **COMPOSITION**, the **CAMERA ANGLE**, the **LIGHTING**, and the **MOOD**.\n\n**Example of POOR variety:**\n1. A red apple on a table.\n2. A green apple on a table.\n3. A blue apple on a table.\n\n**Example of EXCELLENT variety (Your Standard):**\n1.  (Tech) Macro photo of a pristine CPU socket, dramatic blue studio lighting, shallow depth of field, highlighting the gold contacts.\n2.  (Abstract) A 3D render of iridescent, translucent geometric crystals floating in a zero-gravity environment, soft pastel glow, 8K, photorealistic.\n3.  (Industrial) Top-down flat lay of antique, weathered brass woodworking tools arranged neatly on a dark, oiled wood background, warm, rustic lighting.\n4.  (Food) An extreme close-up of a single, perfect coffee bean, with a splash of liquid coffee frozen mid-air, dark and moody cinematic lighting.\n\n---\n**Aesthetic & Quality Control**\n---\n*   **Default Style:** Your default is high-end, clean, and professional. Think premium brand advertisement.\n*   **Keywords:** Automatically infuse prompts with professional keywords: \\\`photorealistic\\\`, \\\`8K\\\`, \\\`hyper-detailed\\\`, \\\`cinematic lighting\\\`, \\\`professional stock photo\\\`, \\\`sharp focus\\\`, \\\`studio quality\\\`.\n*   **User Style Input:** If the user mentions a style (e.g., \\\'vector\\\', \\\'icon\\\'), adapt the prompt to that style. For example, for \\\'vector\\\', you will generate prompts like: "Flat vector icon of a minimalist microscope, #ffffff background, clean lines, corporate style."\n\n---\n**Output Format**\n---\n*   Generate a JSON object with a single key "prompts", containing an array of the generated prompt strings.\n*   If \\\`generateNegativePrompts\\\` is true, each item in the array should be an object formatted like this: { "prompt": "...", "negativePrompt": "..." }. A good negative prompt is simple: "blurry, grainy, people, text, logos, watermark".\n\nYou have {{{count}}} prompts to create. Begin.`;\n\ninterface GeneratedPrompt {\n  prompt: string;\n  negativePrompt?: string;\n}\n\nexport default function PromptGeneratorPage() {\n  const [idea, setIdea] = useState(\'random\');\n  const [count, setCount] = useState(10);\n  const [systemPrompt, setSystemPrompt] = useState(DEFAULT_SYSTEM_PROMPT);\n  const [generatedPrompts, setGeneratedPrompts] = useState<GeneratedPrompt[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n  const [settings] = useSettings();\n\n  // New state for advanced controls\n  const [creativity, setCreativity] = useState<\'low\' | \'medium\' | \'high\' | \'maximum\'>(\'high\');\n  const [imageStyle, setImageStyle] = useState<\'photorealistic\' | \'vector\'>(\'photorealistic\');\n  const [generateNegativePrompts, setGenerateNegativePrompts] = useState(true);\n  const [avoidRepetition, setAvoidRepetition] = useState(true);\n\n  const handleGenerate = async () => {\n    const finalSystemPrompt = systemPrompt.trim() === \'\' ? DEFAULT_SYSTEM_PROMPT : systemPrompt;\n\n    if (!idea.trim()) {\n      toast({ variant: \'destructive\', title: \'Idea is empty\', description: \'Please enter an idea for your image.\' });\n      return;\n    }\n    if (count <= 0) {\n      toast({ variant: \'destructive\', title: \'Invalid number\', description: \'Please enter a number of prompts greater than 0.\' });\n      return;\n    }\n    setIsLoading(true);\n    setGeneratedPrompts([]);\n\n    // Pass the style to the AI via the main idea input, as the master prompt is designed to handle it.\n    const finalIdea = `${idea}, ${imageStyle} style`;\n\n    const result = await runGenerateImagePrompt(finalIdea, count, finalSystemPrompt, settings, {\n        creativity,\n        generateNegativePrompts,\n        avoidRepetition,\n    });\n\n    setIsLoading(false);\n\n    if (\'error\' in result) {\n      toast({ variant: \'destructive\', title: \'Generation Failed\', description: result.error });\n    } else {\n      setGeneratedPrompts(result.prompts || []);\n      toast({ title: \'Prompts Generated!\', description: `${result.prompts?.length || 0} new image prompts are ready.` });\n    }\n  };\n\n  const handleCopy = (text: string) => {\n    navigator.clipboard.writeText(text);\n    toast({ title: \'Copied to clipboard!\' });\n  };\n  \n  const handleDownloadCSV = () => {\n    if (generatedPrompts.length === 0) return;\n\n    let csvContent = "data:text/csv;charset=utf-8,";\n    csvContent += "Serial,Prompt,Negative Prompt\\r\\n"; // Header\n\n    generatedPrompts.forEach((p, index) => {\n        const serial = index + 1;\n        const escapedPrompt = `\"${p.prompt.replace(/\"/g, \'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'\'-